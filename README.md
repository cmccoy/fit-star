# `fit-star`

This package fits various models of DNA evolution to a collection of two-taxon trees, each using data from a single pairwise alignment.

In contrast to standard phylogenetic inference programs, `fit-star` allows the root state of each 2-tree to be fixed to the reference sequence within the pairwise alignment.
Additionally, it assumes that each sequence evolved independently from the known start state - along a star-like phylogeny.

This is unusual.
For inferring full phylogenies [RAxML](http://www.exelixis-lab.org/), [PhyML](http://www.atgc-montpellier.fr/phyml/), or [FastTree](http://www.microbesonline.org/fasttree/) will be more useful.

# Requirements

* libprotobuf-2.4.1-dev
* [beagle-2.1](https://code.google.com/p/beagle-lib/)
* [bpp-core-dev 2.1.0](http://biopp.univ-montp2.fr/)
* [bpp-phyl-dev 2.1.0](http://biopp.univ-montp2.fr/)
* [bpp-seq-dev 2.1.0](http://biopp.univ-montp2.fr/)
* libz-dev
* eigen (included)
* nlopt (included)
* samtools (included)
* boost (included)

# Programs

Functionality is separated into two programs:

## `build-mutation-matrices`

`build-mutation-matrices` transforms each aligned sequence in a BAM file to a 4x4 matrix containing counts of each nucleotide substitution.

If multiple alignments are available for a single sequence, and the sequences are sorted by name, each alignment can form a partition to be fit by `fit-star`.

## `fit-star`

`fit-star` fits various evolutionary models (TN93, HKY85, GTR) to the pairwise substitution matrices generated by `build-mutation-matrices`.

Both model parameters and branch lengths are optimized.

Optimized parameter values and branch lengths are output as JSON.

`fit-star` is multithreaded using OpenMP, and by default uses all the cores available on your machine.
To reduce the number of cores used, set the environment variable `OMP_NUM_THREADS`.

# Compiling

Assuming all required dependencies are present, just run `make`.

Binaries will be placed in `build/src/`.

# Testing

Assuming all required dependencies are present, just run `make test`.
